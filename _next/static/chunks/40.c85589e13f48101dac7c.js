(window.webpackJsonp=window.webpackJsonp||[]).push([[40],{lG9f:function(t,e,a){"use strict";a.r(e),a.d(e,"default",function(){return M});var n=a("pbKT"),i=a.n(n),r=a("MM9K"),l=a.n(r),c=a("iJl9"),s=a.n(c),o=a("Pbn2"),u=a.n(o),d=a("QpBz"),h=a.n(d),g=a("ln6h"),f=a.n(g),m=a("O40h"),v=a("0iUn"),b=a("sLSF"),p=a("AT/M"),w=a("Tit0"),S=a("MI3g"),k=a("a7VT"),y=a("vYYK"),A=a("q1tI"),E=a.n(A),T=a("/ncQ"),C=a("3N+l"),I=a.n(C),P=a("r69/"),j=a("y0A3");a("ZgT4");function L(t){var e=function(){if("undefined"==typeof Reflect||!i.a)return!1;if(i.a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(i()(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var a,n=Object(k.default)(t);if(e){var r=Object(k.default)(this).constructor;a=i()(n,arguments,r)}else a=n.apply(this,arguments);return Object(S.default)(this,a)}}var O=I()(function(){return Promise.all([a.e(0),a.e(1),a.e(14)]).then(a.bind(null,"nnKA"))},{ssr:!1,loading:function(){return Object(j.k)()},loadableGenerated:{webpack:function(){return["nnKA"]},modules:["../writer-simplemde-markdown"]}}),x=I()(function(){return Promise.all([a.e(0),a.e(1),a.e(16)]).then(a.bind(null,"+Etj"))},{ssr:!1,loading:function(){return Object(j.k)()},loadableGenerated:{webpack:function(){return["+Etj"]},modules:["../writer-braftEditor"]}}),M=function(t){Object(w.default)(a,t);var e=L(a);function a(){var t;Object(v.default)(this,a);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return t=e.call.apply(e,[this].concat(i)),Object(y.a)(Object(p.default)(t),"state",{type:null,editorState:null,getArticleContentLoading:!0,selectedArticleId:null,notArticle:!1,uploadImgs:[],defaultImgs:[],articlePublish:"未发布",articleTitle:null,articleSave:"已保存",articleSaveLoading:!1}),t}return Object(b.default)(a,[{key:"componentDidMount",value:function(){var t=this;P.a.on("getSelectedArticleId",function(){var e=Object(m.default)(f.a.mark(function e(a){var n,i;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getArticelContent(a);case 2:(n=e.sent)?(i=1==n.status?"已发布":"未发布",t.setState({editorState:n.raw,articlePublish:i,articleTitle:n.title,selectedArticleId:a,getArticleContentLoading:!1,notArticle:!1,markdown:n.markdown,type:n.type,defaultImgs:n.imgs.map(function(t){return{id:t.id,url:"".concat(j.f).concat(t.f_path)}})}),P.a.trigger("changeMarkDownVal",n.markdown,i,a),P.a.trigger("changeBraftEditorVal",n.raw,i,a)):t.setState({notArticle:!0});case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}())}},{key:"componentWillUnmount",value:function(){P.a.off("getSelectedArticleId")}},{key:"getArticelContent",value:function(t){return t?(this.setState({getArticleContentLoading:!0}),Object(T.a)("auth/get/article/content",{id:t}).then(function(t){return t?t&&t.status&&"succ"===t.status?t.data:(h.a.error(t.message),null):null},function(t){return null})):null}},{key:"articleTitleChange",value:function(t){this.setState({articleTitle:t.target.value,articlePublish:"未发布",articleSave:"未保存"}),P.a.trigger("articleTitleChangeMarkdown"),P.a.trigger("articleTitleChangeBraftEditor",t.target.value),P.a.trigger("articleTitleChange",this.state.selectedArticleId,t.target.value),P.a.trigger("articlePublish",this.state.selectedArticleId,!1)}},{key:"markdownSaveLoading",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.setState({articlePublish:t?"已发布":"未发布",articleSaveLoading:!0,articleSave:"保存中。。"})}},{key:"markdownSave",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.setState({articlePublish:t?"已发布":"未发布",articleSaveLoading:!1,articleSave:"已保存"})}},{key:"markdownChange",value:function(){this.setState({articlePublish:"未发布",articleSave:"未保存"})}},{key:"render",value:function(){var t;return E.a.createElement("div",{style:{height:"100%",overflow:"hidden",textAlign:"left"}},!this.state.notArticle&&E.a.createElement(l.a,{spinning:this.state.getArticleContentLoading,style:{height:"100%"}},E.a.createElement("div",null,E.a.createElement(s.a,{addonAfter:E.a.createElement("div",null,!this.state.articleSaveLoading&&"未保存"===this.state.articleSave&&E.a.createElement(u.a,{type:"exclamation-circle",theme:"twoTone",twoToneColor:"#eb2f96",style:{marginRight:"10px"}}),!this.state.articleSaveLoading&&"已保存"===this.state.articleSave&&E.a.createElement(u.a,{type:"check-circle",theme:"twoTone",twoToneColor:"#52c41a",style:{marginRight:"10px"}}),this.state.articleSaveLoading&&E.a.createElement(u.a,{type:"loading-3-quarters",spin:!0,style:{marginRight:"10px"}}),this.state.articleSave),size:"large",value:this.state.articleTitle,placeholder:"请输入文章标题",onChange:this.articleTitleChange.bind(this)})),0==this.state.type&&E.a.createElement(x,(t={editorState:this.state.editorState,selectedArticleId:this.state.selectedArticleId,defaultImgs:this.state.defaultImgs,articlePublish:this.state.articlePublish,articleTitle:this.state.articleTitle,editorSaveLoading:this.markdownSaveLoading.bind(this),editorChange:this.markdownChange.bind(this)},Object(y.a)(t,"articlePublish",this.state.articlePublish),Object(y.a)(t,"editorSave",this.markdownSave.bind(this)),t)),1===Number(this.state.type)&&E.a.createElement(O,{title:this.state.articleTitle,selectedArticleId:this.state.selectedArticleId,markdownSave:this.markdownSave.bind(this),markdown:this.state.markdown,markdownSaveLoading:this.markdownSaveLoading.bind(this),markdownChange:this.markdownChange.bind(this),articlePublish:this.state.articlePublish})),this.state.notArticle&&E.a.createElement("div",{style:{textAlign:"center"}},E.a.createElement("br",null),E.a.createElement("br",null),E.a.createElement(u.a,{type:"frown",style:{fontSize:"150px"}}),E.a.createElement("br",null),E.a.createElement("br",null),E.a.createElement("h1",{style:{fontSize:"30px",fontWeight:"600"}},"一篇文章都没有，赶快去创建一篇吧")))}}]),a}(A.Component)}}]);